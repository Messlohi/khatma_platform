<!DOCTYPE html>
<html lang="ar">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ø®ØªÙ…Ø§Øª.Ø£ÙˆÙ†Ù„Ø§ÙŠÙ† - Ù†Ø¸Ù… Ø®ØªÙ…ØªÙƒ Ø§Ù„Ø¬Ù…Ø§Ø¹ÙŠØ© Ø¨Ø³Ù‡ÙˆÙ„Ø©</title>
    <meta name="description"
        content="Ù…Ù†ØµØ© Ù…Ø¬Ø§Ù†ÙŠØ© Ù„ØªÙ†Ø¸ÙŠÙ… Ø®ØªÙ…Ø§Øª Ø§Ù„Ù‚Ø±Ø¢Ù† Ø§Ù„ÙƒØ±ÙŠÙ… Ù„Ù„Ø¹Ø§Ø¦Ù„Ø§Øª ÙˆØ§Ù„Ù…Ø¬Ù…ÙˆØ¹Ø§Øª. Ø£Ù†Ø´Ø¦ Ø®ØªÙ…Ø© Ø®Ø§ØµØ©ØŒ Ø´Ø§Ø±Ùƒ Ø§Ù„Ø±Ø§Ø¨Ø·ØŒ ÙˆØªØªØ¨Ø¹ Ø§Ù„Ù‚Ø±Ø§Ø¡Ø© Ù„Ø­Ø¸Ø© Ø¨Ù„Ø­Ø¸Ø©.">
    <meta name="keywords" content="Ø®ØªÙ…Ø©, Ù‚Ø±Ø¢Ù†, Ø®ØªÙ…Ø© Ø§Ù„ÙƒØªØ±ÙˆÙ†ÙŠØ©, ØªÙ†Ø¸ÙŠÙ… Ø®ØªÙ…Ø©, Ø¯Ø¹Ø§Ø¡ Ø§Ù„Ø®ØªÙ…, Khatma, Quran Online">
    <link rel="canonical" href="https://khatma.pythonanywhere.com">

    <!-- Open Graph -->
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://khatma.pythonanywhere.com">
    <meta property="og:title" content="Ø®ØªÙ…Ø§Øª.Ø£ÙˆÙ†Ù„Ø§ÙŠÙ† | Ù…Ù†ØµØ© Ø®ØªÙ… Ø§Ù„Ù‚Ø±Ø¢Ù† Ø§Ù„Ø¬Ù…Ø§Ø¹ÙŠ">
    <meta property="og:description" content="Ù†Ø¸Ù… Ø®ØªÙ…Ø§Øª Ù‚Ø±Ø¢Ù† Ø¹Ø§Ø¦Ù„ÙŠØ© Ø£Ùˆ Ø¬Ù…Ø§Ø¹ÙŠØ© Ø¨Ø³Ù‡ÙˆÙ„Ø©. ØªØªØ¨Ø¹ Ø§Ù„ØªÙ‚Ø¯Ù… ÙˆØ´Ø§Ø±Ùƒ Ø§Ù„Ø£Ø¬Ø±.">
    <meta property="og:image" content="https://khatma.pythonanywhere.com/static/og_home.png">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Outfit:wght@400;700&display=swap" rel="stylesheet">
    <style>
        :root {
            --primary: #065f46;
            --primary-light: #10b981;
            --secondary: #d97706;
            --bg-cream: #fffbeb;
            --text-dark: #1f2937;
            --white: #ffffff;
            --border-gold: #fbbf24;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Inter', 'Outfit', sans-serif;
        }

        body {
            background-color: var(--bg-cream);
            color: var(--text-dark);
            direction: rtl;
            line-height: 1.6;
            min-height: 100vh;
        }

        header {
            text-align: center;
            padding: 50px 20px;
            background: linear-gradient(135deg, var(--primary), #064e3b);
            color: var(--white);
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.1);
        }

        h1 {
            font-size: 2.5rem;
            margin-bottom: 15px;
            color: var(--border-gold);
        }

        .subtitle {
            font-size: 1.2rem;
            opacity: 0.95;
            font-style: italic;
        }

        .container {
            max-width: 700px;
            margin: -30px auto 50px;
            padding: 0 20px;
        }

        .card {
            background: var(--white);
            padding: 40px;
            border-radius: 20px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
            border: 1px solid rgba(217, 119, 6, 0.2);
        }

        .features {
            margin-bottom: 30px;
            padding: 25px;
            background: #f9fafb;
            border-radius: 15px;
            border-left: 4px solid var(--secondary);
        }

        .feature-item {
            display: flex;
            align-items: center;
            gap: 12px;
            margin: 12px 0;
            color: var(--text-dark);
            font-size: 1.05rem;
        }

        .feature-icon {
            font-size: 1.8rem;
            min-width: 40px;
        }

        .form-group {
            margin-bottom: 25px;
        }

        label {
            display: block;
            margin-bottom: 8px;
            color: var(--primary);
            font-weight: 600;
            font-size: 1.05rem;
        }

        input,
        textarea {
            width: 100%;
            padding: 14px;
            border: 2px solid #e5e7eb;
            border-radius: 12px;
            font-size: 1rem;
            transition: all 0.3s;
            background: #fafafa;
        }

        input:focus,
        textarea:focus {
            outline: none;
            border-color: var(--primary);
            background: white;
            box-shadow: 0 0 0 3px rgba(6, 95, 70, 0.1);
        }

        textarea {
            resize: vertical;
            font-family: inherit;
        }

        .btn {
            padding: 16px 32px;
            border: none;
            border-radius: 12px;
            font-size: 1.15rem;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s;
            display: inline-block;
            text-align: center;
        }

        .btn-primary {
            width: 100%;
            background: linear-gradient(135deg, var(--primary-light), var(--primary));
            color: white;
            box-shadow: 0 4px 15px rgba(16, 185, 129, 0.3);
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(16, 185, 129, 0.4);
        }

        .btn-secondary {
            background: var(--secondary);
            color: white;
            margin-top: 15px;
        }

        .btn-secondary:hover {
            background: #b45309;
        }

        .hidden {
            display: none !important;
        }

        .success-box {
            text-align: center;
            padding: 30px;
        }

        .success-icon {
            font-size: 5rem;
            margin-bottom: 20px;
        }

        .success-title {
            color: var(--primary);
            font-size: 1.8rem;
            margin-bottom: 20px;
        }

        .share-link {
            background: #f3f4f6;
            padding: 20px;
            border-radius: 12px;
            margin: 25px 0;
            word-break: break-all;
            font-family: monospace;
            font-size: 1.1rem;
            border: 2px dashed var(--border-gold);
            color: var(--primary);
            font-weight: bold;
        }

        .loading {
            text-align: center;
            padding: 40px;
        }

        .spinner {
            border: 4px solid #f3f4f6;
            border-top: 4px solid var(--primary);
            border-radius: 50%;
            width: 50px;
            height: 50px;
            animation: spin 1s linear infinite;
            margin: 0 auto 20px;
        }

        @keyframes spin {
            0% {
                transform: rotate(0deg);
            }

            100% {
                transform: rotate(360deg);
            }
        }

        .lang-selector {
            text-align: center;
            margin-bottom: 20px;
        }

        .lang-btn {
            padding: 8px 16px;
            margin: 0 5px;
            border: 2px solid var(--primary-light);
            background: white;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s;
            color: var(--primary);
            font-weight: 600;
        }

        .lang-btn.active {
            background: var(--primary);
            color: white;
            border-color: var(--primary);
        }

        .back-btn {
            background: #e5e7eb;
            color: #374151;
            padding: 10px 20px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            margin-bottom: 25px;
            font-size: 1rem;
        }

        .back-btn:hover {
            background: #d1d5db;
        }

        footer {
            text-align: center;
            padding: 30px;
            color: #6b7280;
            font-size: 0.95rem;
        }

        .islamic-pattern {
            opacity: 0.03;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            background-image: repeating-linear-gradient(45deg, var(--primary) 0, var(--primary) 1px, transparent 0, transparent 50%);
            background-size: 20px 20px;
        }
    </style>
</head>

<body>
    <div class="islamic-pattern"></div>

    <header>
        <h1 data-t="header_title">ğŸ•Œ Ù†Ø¸Ø§Ù… Ø§Ù„Ø®ØªÙ…Ø§Øª Ø§Ù„Ø¬Ù…Ø§Ø¹ÙŠØ©</h1>
        <p class="subtitle" data-t="header_subtitle">Ù†Ø¸Ù… Ø®ØªÙ…Ø© Ù‚Ø±Ø¢Ù† ÙƒØ±ÙŠÙ… Ù„Ø¹Ø§Ø¦Ù„ØªÙƒ Ø£Ùˆ Ù…Ø¬Ù…ÙˆØ¹ØªÙƒ Ø¨Ø³Ù‡ÙˆÙ„Ø©</p>
    </header>

    <div class="container">
        <!-- Language Selector -->
        <div class="lang-selector">
            <button class="lang-btn active" onclick="setLang('ar')">Ø§Ù„Ø¹Ø±Ø¨ÙŠØ©</button>
            <button class="lang-btn" onclick="setLang('en')">English</button>
            <button class="lang-btn" onclick="setLang('fr')">FranÃ§ais</button>
        </div>

        <div class="card">
            <!-- Welcome Screen -->
            <div id="welcome-screen">
                <div class="features">
                    <div class="feature-item">
                        <span class="feature-icon">âœ…</span>
                        <span data-t="feature1">ØªÙˆØ²ÙŠØ¹ 60 Ø­Ø²Ø¨ Ø¹Ù„Ù‰ Ø§Ù„Ù…Ø´Ø§Ø±ÙƒÙŠÙ†</span>
                    </div>
                    <div class="feature-item">
                        <span class="feature-icon">ğŸ“Š</span>
                        <span data-t="feature2">Ù…ØªØ§Ø¨Ø¹Ø© Ø§Ù„ØªÙ‚Ø¯Ù… Ù…Ø¨Ø§Ø´Ø±Ø© ÙÙŠ Ø§Ù„ÙˆÙ‚Øª Ø§Ù„ÙØ¹Ù„ÙŠ</span>
                    </div>
                    <div class="feature-item">
                        <span class="feature-icon">ğŸ”—</span>
                        <span data-t="feature3">Ø±Ø§Ø¨Ø· ÙØ±ÙŠØ¯ Ù„ÙƒÙ„ Ø®ØªÙ…Ø© Ù„Ø³Ù‡ÙˆÙ„Ø© Ø§Ù„Ù…Ø´Ø§Ø±ÙƒØ©</span>
                    </div>
                    <div class="feature-item">
                        <span class="feature-icon">ğŸ¤²</span>
                        <span data-t="feature4">Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ù†ÙŠØ© ÙˆØ§Ù„Ø¯Ø¹Ø§Ø¡ Ø§Ù„Ø®Ø§Øµ Ø¨Ø§Ù„Ø®ØªÙ…Ø©</span>
                    </div>
                    <div class="feature-item">
                        <span class="feature-icon">ğŸ”„</span>
                        <span data-t="feature5">Ø§Ù„Ø®ØªÙ…Ø© ØªØªØ¬Ø¯Ø¯ ØªÙ„Ù‚Ø§Ø¦ÙŠØ§Ù‹ Ø¹Ù†Ø¯ Ø§Ù„Ø¥ÙƒÙ…Ø§Ù„</span>
                    </div>
                </div>

                <button class="btn btn-primary" onclick="showCreateForm()" data-t="create_btn">Ø¥Ù†Ø´Ø§Ø¡ Ø®ØªÙ…Ø© Ø¬Ø¯ÙŠØ¯Ø©
                    âœ¨</button>
                <button class="btn btn-secondary" onclick="showAdminLogin()" style="width: 100%; margin-top: 15px;"
                    data-t="admin_login_title">ğŸ”‘
                    Ø¯Ø®ÙˆÙ„ Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ…</button>
            </div>

            <!-- Create Form -->
            <div id="create-form" class="hidden">
                <button class="back-btn" onclick="showWelcome()">â† <span data-t="back">Ø±Ø¬ÙˆØ¹</span></button>

                <h2 style="margin-bottom: 10px; color: var(--primary);" data-t="form_title">Ø¥Ù†Ø´Ø§Ø¡ Ø®ØªÙ…Ø© Ø¬Ø¯ÙŠØ¯Ø©</h2>
                <p style="margin-bottom: 30px; color: #6b7280;" data-t="form_subtitle">Ø§Ù…Ù„Ø£ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„ØªØ§Ù„ÙŠØ© Ù„Ø¥Ù†Ø´Ø§Ø¡
                    Ø®ØªÙ…ØªÙƒ</p>

                <form onsubmit="createKhatma(event)">
                    <div class="form-group">
                        <label data-t="khatma_name">ğŸ“– Ø§Ø³Ù… Ø§Ù„Ø®ØªÙ…Ø©</label>
                        <input type="text" id="khatma-name" placeholder="Ù…Ø«Ø§Ù„: Ø®ØªÙ…Ø© Ø¹Ø§Ø¦Ù„Ø© Ø§Ù„Ù…Ø­Ù…Ø¯" required>
                    </div>

                    <div class="form-group">
                        <label data-t="admin_name">ğŸ‘¤ Ø§Ø³Ù… Ø§Ù„Ù…Ù†Ø¸Ù… (Ø§Ù„Ø£Ø¯Ù…Ù†)</label>
                        <input type="text" id="admin-name" placeholder="Ø§Ø³Ù…Ùƒ Ø§Ù„ÙƒØ§Ù…Ù„" required>
                    </div>

                    <div class="form-group">
                        <label data-t="admin_pin">ğŸ”’ Ø±Ù…Ø² Ø³Ø±ÙŠ (4 Ø£Ø±Ù‚Ø§Ù…)</label>
                        <input type="password" id="admin-pin" placeholder="â€¢â€¢â€¢â€¢" maxlength="4" pattern="[0-9]{4}"
                            required>
                        <small style="color: #6b7280; font-size: 0.9rem;">* Ù„Ù„ØªØ­ÙƒÙ… ÙÙŠ Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„Ø®ØªÙ…Ø© Ù„Ø§Ø­Ù‚Ø§Ù‹</small>
                    </div>

                    <div class="form-group">
                        <label>ğŸ“… Ù…ÙˆØ¹Ø¯ Ø§Ù„Ø¥Ù†ØªÙ‡Ø§Ø¡ (Ø§Ø®ØªÙŠØ§Ø±ÙŠ)</label>
                        <input type="date" id="deadline" style="background: #fafafa;">
                        <small style="color: #6b7280; font-size: 0.9rem;">* ÙŠÙ…ÙƒÙ†Ùƒ ØªØºÙŠÙŠØ±Ù‡ Ù„Ø§Ø­Ù‚Ø§Ù‹ Ù…Ù† Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ…</small>
                    </div>

                    <div class="form-group">
                        <label data-t="intention">ğŸ¤² Ø§Ù„Ù†ÙŠØ© / Ø§Ù„Ø¯Ø¹Ø§Ø¡ (Ø§Ø®ØªÙŠØ§Ø±ÙŠ)</label>
                        <textarea id="intention" rows="3"
                            placeholder="Ø§Ù„Ù„Ù‡Ù… Ø§Ø¬Ø¹Ù„Ù‡Ø§ Ø®ØªÙ…Ø© Ù…Ø¨Ø§Ø±ÙƒØ© ÙÙŠ Ù…ÙŠØ²Ø§Ù† Ø­Ø³Ù†Ø§ØªÙ†Ø§..."></textarea>
                    </div>

                    <button type="submit" class="btn btn-primary" data-t="create_submit">Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„Ø®ØªÙ…Ø© Ø§Ù„Ø¢Ù† âœ¨</button>
                </form>
            </div>

            <!-- Loading -->
            <div id="loading" class="hidden">
                <div class="loading">
                    <div class="spinner"></div>
                    <p style="font-size: 1.1rem; color: var(--primary);" data-t="creating">Ø¬Ø§Ø±ÙŠ Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„Ø®ØªÙ…Ø©...</p>
                </div>
            </div>

            <!-- Success -->
            <div id="success-screen" class="hidden">
                <div class="success-box">
                    <div class="success-icon">ğŸ‰</div>
                    <h2 class="success-title" data-t="success_title">ØªÙ… Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„Ø®ØªÙ…Ø© Ø¨Ù†Ø¬Ø§Ø­!</h2>

                    <p style="margin-bottom: 15px; font-size: 1.05rem;" data-t="share_label">Ø´Ø§Ø±Ùƒ Ù‡Ø°Ø§ Ø§Ù„Ø±Ø§Ø¨Ø· Ù…Ø¹ Ø¹Ø§Ø¦Ù„ØªÙƒ:
                    </p>
                    <div class="share-link" id="khatma-link"></div>

                    <button class="btn btn-secondary" onclick="copyLink()" style="width: 100%;" data-t="copy_link">ğŸ“‹
                        Ù†Ø³Ø® Ø§Ù„Ø±Ø§Ø¨Ø·</button>
                    <!-- Share Button (Native) -->
                    <button class="btn btn-outline" onclick="shareLink()" style="width: 100%; margin-top: 10px;"
                        id="share-btn" data-t="share_btn">ğŸ“¤ Ù…Ø´Ø§Ø±ÙƒØ© Ø§Ù„Ø±Ø§Ø¨Ø·</button>

                    <button class="btn btn-primary" onclick="goToKhatma()" style="margin-top: 15px;"
                        data-t="goto_khatma">Ø§Ù„Ø°Ù‡Ø§Ø¨ Ø¥Ù„Ù‰ Ø§Ù„Ø®ØªÙ…Ø© â†’</button>
                </div>
            </div>

            <!-- Admin Login Form -->
            <div id="admin-login" class="hidden">
                <button class="back-btn" onclick="showWelcome()">â† <span data-t="back">Ø±Ø¬ÙˆØ¹</span></button>

                <h2 style="margin-bottom: 10px; color: var(--primary);" data-t="admin_login_title">ğŸ”‘ Ø¯Ø®ÙˆÙ„ Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ…
                </h2>
                <p style="margin-bottom: 30px; color: #6b7280;" data-t="admin_login_subtitle">Ø£Ø¯Ø®Ù„ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø£Ø¯Ù…Ù† Ù„Ù„ÙˆØµÙˆÙ„
                    Ø¥Ù„Ù‰ Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ…</p>

                <form onsubmit="adminLogin(event)">
                    <div class="form-group">
                        <label data-t="admin_login_name_label">ğŸ‘¤ Ø§Ø³Ù… Ø§Ù„Ø£Ø¯Ù…Ù†</label>
                        <input type="text" id="admin-login-name" required>
                    </div>

                    <div class="form-group">
                        <label data-t="admin_login_pin_label">ğŸ”’ Ø§Ù„Ø±Ù…Ø² Ø§Ù„Ø³Ø±ÙŠ</label>
                        <input type="password" id="admin-login-pin" placeholder="â€¢â€¢â€¢â€¢" required>
                    </div>

                    <div class="form-group">
                        <label data-t="admin_login_id_label">ğŸ”— Ù…Ø¹Ø±Ù Ø§Ù„Ø®ØªÙ…Ø© (Khatma ID)</label>
                        <input type="text" id="admin-khatma-id" placeholder="abc123" required>
                        <small style="color: #6b7280; font-size: 0.9rem;" data-t="admin_login_id_hint">* Ù…Ø¹Ø±Ù Ø§Ù„Ø®ØªÙ…Ø©
                            Ù…ÙˆØ¬ÙˆØ¯ ÙÙŠ Ø§Ù„Ø±Ø§Ø¨Ø·:
                            /<strong>abc123</strong></small>
                    </div>

                    <button type="submit" class="btn btn-primary" data-t="admin_login_btn">Ø¯Ø®ÙˆÙ„ Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ… â†’</button>
                </form>
            </div>
        </div>
    </div>

    <footer>
        <p data-t="footer_text">ğŸ•Œ ØªÙ‚Ø¨Ù„ Ø§Ù„Ù„Ù‡ Ø·Ø§Ø¹ØªÙƒÙ… â€¢ Ù†Ø¸Ø§Ù… Ø§Ù„Ø®ØªÙ…Ø§Øª Ø§Ù„Ø¬Ù…Ø§Ø¹ÙŠØ© 2026</p>
    </footer>

    <script>
        let currentLang = 'ar';
        let createdKhatmaId = '';

        const translations = {
            ar: {
                feature1: "ØªÙˆØ²ÙŠØ¹ 60 Ø­Ø²Ø¨ Ø¹Ù„Ù‰ Ø§Ù„Ù…Ø´Ø§Ø±ÙƒÙŠÙ†",
                feature2: "Ù…ØªØ§Ø¨Ø¹Ø© Ø§Ù„ØªÙ‚Ø¯Ù… Ù…Ø¨Ø§Ø´Ø±Ø© ÙÙŠ Ø§Ù„ÙˆÙ‚Øª Ø§Ù„ÙØ¹Ù„ÙŠ",
                feature3: "Ø±Ø§Ø¨Ø· ÙØ±ÙŠØ¯ Ù„ÙƒÙ„ Ø®ØªÙ…Ø© Ù„Ø³Ù‡ÙˆÙ„Ø© Ø§Ù„Ù…Ø´Ø§Ø±ÙƒØ©",
                feature4: "Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ù†ÙŠØ© ÙˆØ§Ù„Ø¯Ø¹Ø§Ø¡ Ø§Ù„Ø®Ø§Øµ Ø¨Ø§Ù„Ø®ØªÙ…Ø©",
                feature5: "Ø§Ù„Ø®ØªÙ…Ø© ØªØªØ¬Ø¯Ø¯ ØªÙ„Ù‚Ø§Ø¦ÙŠØ§Ù‹ Ø¹Ù†Ø¯ Ø§Ù„Ø¥ÙƒÙ…Ø§Ù„",
                create_btn: "Ø¥Ù†Ø´Ø§Ø¡ Ø®ØªÙ…Ø© Ø¬Ø¯ÙŠØ¯Ø© âœ¨",
                back: "Ø±Ø¬ÙˆØ¹",
                form_title: "Ø¥Ù†Ø´Ø§Ø¡ Ø®ØªÙ…Ø© Ø¬Ø¯ÙŠØ¯Ø©",
                form_subtitle: "Ø§Ù…Ù„Ø£ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„ØªØ§Ù„ÙŠØ© Ù„Ø¥Ù†Ø´Ø§Ø¡ Ø®ØªÙ…ØªÙƒ",
                khatma_name: "ğŸ“– Ø§Ø³Ù… Ø§Ù„Ø®ØªÙ…Ø©",
                admin_name: "ğŸ‘¤ Ø§Ø³Ù… Ø§Ù„Ù…Ù†Ø¸Ù… (Ø§Ù„Ø£Ø¯Ù…Ù†)",
                admin_pin: "ğŸ”’ Ø±Ù…Ø² Ø³Ø±ÙŠ (4 Ø£Ø±Ù‚Ø§Ù…)",
                intention: "ğŸ¤² Ø§Ù„Ù†ÙŠØ© / Ø§Ù„Ø¯Ø¹Ø§Ø¡ (Ø§Ø®ØªÙŠØ§Ø±ÙŠ)",
                create_submit: "Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„Ø®ØªÙ…Ø© Ø§Ù„Ø¢Ù† âœ¨",
                creating: "Ø¬Ø§Ø±ÙŠ Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„Ø®ØªÙ…Ø©...",
                success_title: "ØªÙ… Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„Ø®ØªÙ…Ø© Ø¨Ù†Ø¬Ø§Ø­!",
                share_label: "Ø´Ø§Ø±Ùƒ Ù‡Ø°Ø§ Ø§Ù„Ø±Ø§Ø¨Ø· Ù…Ø¹ Ø¹Ø§Ø¦Ù„ØªÙƒ:",
                copy_link: "ğŸ“‹ Ù†Ø³Ø® Ø§Ù„Ø±Ø§Ø¨Ø·",
                goto_khatma: "Ø§Ù„Ø°Ù‡Ø§Ø¨ Ø¥Ù„Ù‰ Ø§Ù„Ø®ØªÙ…Ø© â†’",
                // Header & Footer
                header_title: "ğŸ•Œ Ù†Ø¸Ø§Ù… Ø§Ù„Ø®ØªÙ…Ø§Øª Ø§Ù„Ø¬Ù…Ø§Ø¹ÙŠØ©",
                header_subtitle: "Ù†Ø¸Ù… Ø®ØªÙ…Ø© Ù‚Ø±Ø¢Ù† ÙƒØ±ÙŠÙ… Ù„Ø¹Ø§Ø¦Ù„ØªÙƒ Ø£Ùˆ Ù…Ø¬Ù…ÙˆØ¹ØªÙƒ Ø¨Ø³Ù‡ÙˆÙ„Ø©",
                footer_text: "ğŸ•Œ ØªÙ‚Ø¨Ù„ Ø§Ù„Ù„Ù‡ Ø·Ø§Ø¹ØªÙƒÙ… â€¢ Ù†Ø¸Ø§Ù… Ø§Ù„Ø®ØªÙ…Ø§Øª Ø§Ù„Ø¬Ù…Ø§Ø¹ÙŠØ© 2026",
                // Admin Login
                admin_login_title: "ğŸ”‘ Ø¯Ø®ÙˆÙ„ Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ…",
                admin_login_subtitle: "Ø£Ø¯Ø®Ù„ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø£Ø¯Ù…Ù† Ù„Ù„ÙˆØµÙˆÙ„ Ø¥Ù„Ù‰ Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ…",
                admin_login_name_label: "ğŸ‘¤ Ø§Ø³Ù… Ø§Ù„Ø£Ø¯Ù…Ù†",
                admin_login_pin_label: "ğŸ”’ Ø§Ù„Ø±Ù…Ø² Ø§Ù„Ø³Ø±ÙŠ",
                admin_login_id_label: "ğŸ”— Ù…Ø¹Ø±Ù Ø§Ù„Ø®ØªÙ…Ø© (Khatma ID)",
                admin_login_id_hint: "* Ù…Ø¹Ø±Ù Ø§Ù„Ø®ØªÙ…Ø© Ù…ÙˆØ¬ÙˆØ¯ ÙÙŠ Ø§Ù„Ø±Ø§Ø¨Ø·: /<strong>abc123</strong>",
                admin_login_btn: "Ø¯Ø®ÙˆÙ„ Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ… â†’",
                // Alerts & Errors
                alert_success_copy: "âœ… ØªÙ… Ù†Ø³Ø® Ø§Ù„Ø±Ø§Ø¨Ø·!",
                // Share
                share_btn: "ğŸ“¤ Ù…Ø´Ø§Ø±ÙƒØ© Ø§Ù„Ø±Ø§Ø¨Ø·",
                alert_error_create: "ÙØ´Ù„ ÙÙŠ Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„Ø®ØªÙ…Ø©",
                alert_error_login: "Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø£Ø¯Ù…Ù† ØºÙŠØ± ØµØ­ÙŠØ­Ø© Ø£Ùˆ Ù„ÙŠØ³ Ù„Ø¯ÙŠÙƒ ØµÙ„Ø§Ø­ÙŠØ§Øª",
                alert_error_connection: "Ø®Ø·Ø£ ÙÙŠ Ø§Ù„Ø§ØªØµØ§Ù„: "
            },
            en: {
                feature1: "Distribute 60 Hizbs among participants",
                feature2: "Live real-time progress tracking",
                feature3: "Unique link for each Khatma for easy sharing",
                feature4: "Add custom intention and prayers",
                feature5: "Khatma auto-renews upon completion",
                create_btn: "Create New Khatma âœ¨",
                back: "Back",
                form_title: "Create New Khatma",
                form_subtitle: "Fill in the details to create your Khatma",
                khatma_name: "ğŸ“– Khatma Name",
                admin_name: "ğŸ‘¤ Organizer Name (Admin)",
                admin_pin: "ğŸ”’ Secret PIN (4 digits)",
                intention: "ğŸ¤² Intention / Prayer (optional)",
                create_submit: "Create Khatma Now âœ¨",
                creating: "Creating Khatma...",
                success_title: "Khatma Created Successfully!",
                share_label: "Share this link with your family:",
                copy_link: "ğŸ“‹ Copy Link",
                goto_khatma: "Go to Khatma â†’",
                // Header & Footer
                header_title: "ğŸ•Œ Family Khatma System",
                header_subtitle: "Organize a Quran Khatma for your family or group easily",
                footer_text: "ğŸ•Œ May Allah accept your deeds â€¢ Family Khatma System 2026",
                // Admin Login
                admin_login_title: "ğŸ”‘ Admin Login",
                admin_login_subtitle: "Enter admin credentials to access control panel",
                admin_login_name_label: "ğŸ‘¤ Admin Name",
                admin_login_pin_label: "ğŸ”’ Secret PIN",
                admin_login_id_label: "ğŸ”— Khatma ID",
                admin_login_id_hint: "* Khatma ID is in the link: /<strong>abc123</strong>",
                admin_login_btn: "Enter Control Panel â†’",
                // Alerts & Errors
                alert_success_copy: "âœ… Link copied!",
                // Share
                share_btn: "ğŸ“¤ Share Link",
                alert_error_create: "Failed to create Khatma",
                alert_error_login: "Invalid credentials or unauthorized",
                alert_error_connection: "Connection error: "
            },
            fr: {
                feature1: "Distribuer 60 Hizbs entre les participants",
                feature2: "Suivi en temps rÃ©el de la progression",
                feature3: "Lien unique pour chaque Khatma",
                feature4: "Ajouter intention et priÃ¨res personnalisÃ©es",
                feature5: "La Khatma se renouvelle automatiquement",
                create_btn: "CrÃ©er une Nouvelle Khatma âœ¨",
                back: "Retour",
                form_title: "CrÃ©er une Nouvelle Khatma",
                form_subtitle: "Remplissez les dÃ©tails pour crÃ©er votre Khatma",
                khatma_name: "ğŸ“– Nom de la Khatma",
                admin_name: "ğŸ‘¤ Nom de l'organisateur (Admin)",
                admin_pin: "ğŸ”’ Code PIN (4 chiffres)",
                intention: "ğŸ¤² Intention / PriÃ¨re (optionnel)",
                create_submit: "CrÃ©er la Khatma Maintenant âœ¨",
                creating: "CrÃ©ation de la Khatma...",
                success_title: "Khatma CrÃ©Ã©e avec SuccÃ¨s!",
                share_label: "Partagez ce lien avec votre famille:",
                copy_link: "ğŸ“‹ Copier le Lien",
                goto_khatma: "Aller Ã  la Khatma â†’",
                // Header & Footer
                header_title: "ğŸ•Œ SystÃ¨me de Khatma Familiale",
                header_subtitle: "Organisez facilement une Khatma Coranique",
                footer_text: "ğŸ•Œ Qu'Allah accepte vos actions â€¢ SystÃ¨me de Khatma 2026",
                // Admin Login
                admin_login_title: "ğŸ”‘ Connexion Admin",
                admin_login_subtitle: "Entrez vos identifiants pour accÃ©der au panneau",
                admin_login_name_label: "ğŸ‘¤ Nom Admin",
                admin_login_pin_label: "ğŸ”’ Code PIN",
                admin_login_id_label: "ğŸ”— ID Khatma",
                admin_login_id_hint: "* The ID is in the link: /<strong>abc123</strong>",
                admin_login_btn: "AccÃ©der au Panneau â†’",
                // Alerts & Errors
                alert_success_copy: "âœ… Lien copiÃ© !",
                // Share
                share_btn: "ğŸ“¤ Partager le lien",
                alert_error_create: "Ã‰chec de crÃ©ation de la Khatma",
                alert_error_login: "Identifiants invalides ou non autorisÃ©",
                alert_error_connection: "Erreur de connexion : "
            }
        };

        function setLang(lang) {
            currentLang = lang;
            document.documentElement.lang = lang;
            document.documentElement.dir = lang === 'ar' ? 'rtl' : 'ltr';
            document.body.dir = lang === 'ar' ? 'rtl' : 'ltr';

            document.querySelectorAll('.lang-btn').forEach(btn => btn.classList.remove('active'));
            event.target.classList.add('active');

            document.querySelectorAll('[data-t]').forEach(el => {
                const key = el.getAttribute('data-t');
                if (translations[lang][key]) {
                    if (el.tagName === 'INPUT' || el.tagName === 'TEXTAREA') {
                        el.placeholder = translations[lang][key];
                    } else if (key === 'admin_login_id_hint' || key === 'header_subtitle') {
                        el.innerHTML = translations[lang][key]; // Handle HTML content
                    } else {
                        el.textContent = translations[lang][key];
                    }
                }
            });
            // Update document title
            document.title = lang === 'ar' ? 'Ù†Ø¸Ø§Ù… Ø§Ù„Ø®ØªÙ…Ø§Øª Ø§Ù„Ø¬Ù…Ø§Ø¹ÙŠØ©' : (lang === 'fr' ? 'SystÃ¨me de Khatma Familiale' : 'Family Khatma System');
        }

        function showWelcome() {
            document.getElementById('welcome-screen').classList.remove('hidden');
            document.getElementById('create-form').classList.add('hidden');
            document.getElementById('success-screen').classList.add('hidden');
            document.getElementById('loading').classList.add('hidden');
        }

        function showCreateForm() {
            document.getElementById('welcome-screen').classList.add('hidden');
            document.getElementById('create-form').classList.remove('hidden');
        }

        async function createKhatma(event) {
            event.preventDefault();

            const khatmaName = document.getElementById('khatma-name').value;
            const adminName = document.getElementById('admin-name').value;
            const adminPin = document.getElementById('admin-pin').value;
            const intention = document.getElementById('intention').value;
            const deadline = document.getElementById('deadline').value;

            document.getElementById('create-form').classList.add('hidden');
            document.getElementById('loading').classList.remove('hidden');

            try {
                const response = await fetch('/api/khatma/create', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({
                        name: khatmaName,
                        admin_name: adminName,
                        admin_pin: adminPin,
                        intention: intention || '',
                        deadline: deadline || null
                    })
                });

                const data = await response.json();

                if (data.success) {
                    createdKhatmaId = data.khatma_id;
                    const link = `${window.location.origin}/${createdKhatmaId}`;
                    document.getElementById('khatma-link').textContent = link;

                    // IMPORTANT: Store admin credentials for automatic login
                    localStorage.setItem('web_user_name', adminName);
                    localStorage.setItem('web_user_pin', adminPin);
                    localStorage.setItem('web_user_uid', data.admin_uid);
                    localStorage.setItem('is_admin', 'true');
                    localStorage.setItem('admin_khatma_id', createdKhatmaId);

                    document.getElementById('loading').classList.add('hidden');
                    document.getElementById('success-screen').classList.remove('hidden');
                } else {
                    alert((translations[currentLang].alert_error_create || 'Error') + ': ' + (data.error || ''));
                    document.getElementById('loading').classList.add('hidden');
                    document.getElementById('create-form').classList.remove('hidden');
                }
            } catch (error) {
                alert((translations[currentLang].alert_error_connection || 'Connection Error') + ': ' + error);
                document.getElementById('loading').classList.add('hidden');
                document.getElementById('create-form').classList.remove('hidden');
            }
        }

        function copyLink() {
            const link = document.getElementById('khatma-link').textContent;
            navigator.clipboard.writeText(link).then(() => {
                alert(translations[currentLang].alert_success_copy || 'âœ… Link copied!');
            });
        }

        function goToKhatma() {
            window.location.href = `/${createdKhatmaId}`;
        }

        function showAdminLogin() {
            document.getElementById('welcome-screen').classList.add('hidden');
            document.getElementById('create-form').classList.add('hidden');
            document.getElementById('admin-login').classList.remove('hidden');
        }

        async function adminLogin(event) {
            event.preventDefault();

            const adminName = document.getElementById('admin-login-name').value;
            const adminPin = document.getElementById('admin-login-pin').value;
            const khatmaId = document.getElementById('admin-khatma-id').value;

            document.getElementById('admin-login').classList.add('hidden');
            document.getElementById('loading').classList.remove('hidden');

            try {
                // Verify admin credentials
                const response = await fetch('/api/login', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({
                        name: adminName,
                        pin: adminPin,
                        khatma_id: khatmaId
                    })
                });

                const data = await response.json();

                if (data.success && data.is_admin) {
                    // Store admin session
                    localStorage.setItem('web_user_name', adminName);
                    localStorage.setItem('web_user_pin', adminPin);
                    localStorage.setItem('web_user_uid', data.uid);
                    localStorage.setItem('is_admin', 'true');
                    localStorage.setItem('admin_khatma_id', khatmaId);

                    // Redirect to Khatma control panel
                    window.location.href = `/${khatmaId}`;
                } else {
                    alert((translations[currentLang].alert_error_login || 'Invalid credentials') + ': ' + (data.error || ''));
                    document.getElementById('loading').classList.add('hidden');
                    document.getElementById('admin-login').classList.remove('hidden');
                }
            } catch (error) {
                alert((translations[currentLang].alert_error_connection || 'Connection Error') + ': ' + error);
                document.getElementById('loading').classList.add('hidden');
                document.getElementById('admin-login').classList.remove('hidden');
            }
        }


        // Fix: Implement missing shareLink function
        function shareLink() {
            const link = document.getElementById('khatma-link').textContent;
            if (navigator.share) {
                navigator.share({
                    title: 'Khatma',
                    text: 'Join our Quran Khatma',
                    url: link
                }).catch(err => console.log('Share failed', err));
            } else {
                copyLink(); // Fallback
            }
        }

        function toggleAdminFields() {
            const enabled = document.getElementById('enable-admin').checked;
            const fields = document.getElementById('admin-fields');
            if (enabled) {
                fields.classList.remove('hidden');
                document.getElementById('admin-name').required = true;
                document.getElementById('admin-pin').required = true;
            } else {
                fields.classList.add('hidden');
                document.getElementById('admin-name').required = false;
                document.getElementById('admin-pin').required = false;
            }
        }
    </script>
</body>

</html>